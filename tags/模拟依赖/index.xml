<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>模拟依赖 on cmdragon's Blog</title><link>https://blog.cmdragon.cn/tags/%E6%A8%A1%E6%8B%9F%E4%BE%9D%E8%B5%96/</link><description>Recent content in 模拟依赖 on cmdragon's Blog</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Wed, 10 Sep 2025 06:22:28 +0800</lastBuildDate><atom:link href="https://blog.cmdragon.cn/tags/%E6%A8%A1%E6%8B%9F%E4%BE%9D%E8%B5%96/index.xml" rel="self" type="application/rss+xml"/><item><title>如何用FastAPI玩转多模块测试与异步任务，让代码不再“闹脾气”？</title><link>https://blog.cmdragon.cn/posts/ddbfa0447a5d0d6f9af12e7a6b206f70/</link><pubDate>Wed, 10 Sep 2025 06:22:28 +0800</pubDate><guid>https://blog.cmdragon.cn/posts/ddbfa0447a5d0d6f9af12e7a6b206f70/</guid><description>FastAPI框架在多模块集成测试中，通过&lt;code&gt;pytest&lt;/code&gt;的&lt;code&gt;fixture&lt;/code&gt;创建临时数据库，确保测试数据隔离，并使用&lt;code&gt;unittest.mock&lt;/code&gt;模拟外部依赖，验证模块间交互。异步任务通过&lt;code&gt;BackgroundTasks&lt;/code&gt;处理，定时任务则借助&lt;code&gt;APScheduler&lt;/code&gt;实现，测试时手动触发任务以验证逻辑。常见报错如&lt;code&gt;422 Validation Error&lt;/code&gt;和&lt;code&gt;503 ServiceError&lt;/code&gt;，可通过检查请求字段类型和服务连接解决。运行环境需Python 3.10+，依赖库包括&lt;code&gt;fastapi&lt;/code&gt;、&lt;code&gt;pytest&lt;/code&gt;等。</description></item><item><title>如何在FastAPI中巧妙隔离依赖项，让单元测试不再头疼？</title><link>https://blog.cmdragon.cn/posts/77ae327dc941b0e74ecc6a8794c084d0/</link><pubDate>Wed, 03 Sep 2025 06:10:25 +0800</pubDate><guid>https://blog.cmdragon.cn/posts/77ae327dc941b0e74ecc6a8794c084d0/</guid><description>FastAPI单元测试是确保应用质量的关键，尤其依赖注入系统的隔离测试至关重要。通过依赖注入机制，FastAPI能自动解析函数参数并执行依赖函数，将返回值注入路由处理函数。测试时，可使用&lt;code&gt;dependency_overrides&lt;/code&gt;替换依赖项，模拟不同场景。单元测试应占据最大比重，避免外部服务不可用导致的测试失败。测试技巧包括模拟依赖返回、依赖项层级隔离和异步依赖处理。实战案例展示了用户认证测试的具体实现，确保权限验证逻辑正确。</description></item></channel></rss>